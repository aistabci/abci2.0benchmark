Warning:  if --fp16 is not used, static_loss_scale will be ignored.
=> creating model '('resnet50', 'classic', 1000)'
Version: {'net': <class 'image_classification.resnet.ResNet'>, 'block': <class 'image_classification.resnet.Bottleneck'>, 'layers': [3, 4, 6, 3], 'widths': [64, 128, 256, 512], 'expansion': 4}
Config: {'conv': <class 'torch.nn.modules.conv.Conv2d'>, 'conv_init': 'fan_out', 'nonlinearity': 'relu', 'last_bn_0_init': False, 'activation': <function <lambda> at 0x152b5b977700>}
Num classes: 1000
read 1281167 files from 1000 directories
read 50000 files from 1000 directories
DLL 2021-05-28 17:14:03.874448 - PARAMETER data : /local/7164550.1.gpua/imagenet  data_backend : dali-cpu  arch : resnet50  model_config : classic  num_classes : 1000  workers : 5  epochs : 1  run_epochs : -1  batch_size : 256  optimizer_batch_size : -1  lr : 0.1  lr_schedule : step  warmup : 0  label_smoothing : 0.0  mixup : 0.0  momentum : 0.9  weight_decay : 0.0001  bn_weight_decay : False  nesterov : False  print_freq : 1  resume : None  pretrained_weights :   fp16 : False  static_loss_scale : 256.0  dynamic_loss_scale : False  prof : 100  amp : True  seed : None  gather_checkpoints : False  raport_file : job_gpu8.sh.7164550.result.amp.json  evaluate : False  training_only : True  save_checkpoints : False  checkpoint_filename : checkpoint.pth.tar  workspace : ./  memory_format : nchw  distributed : True  local_rank : 0  gpu : 0  world_size : 8 
 ! Weight decay NOT applied to BN parameters 
98
63
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : 256.0
RUNNING EPOCHS FROM 0 TO 1
DLL 2021-05-28 17:14:55.123569 - Epoch: 0 Iteration: 1  train.loss : 7.10300  train.total_ips : 43.15 img/s
DLL 2021-05-28 17:14:55.340242 - Epoch: 0 Iteration: 2  train.loss : 7.02387  train.total_ips : 9455.19 img/s
DLL 2021-05-28 17:14:55.555770 - Epoch: 0 Iteration: 3  train.loss : 7.03194  train.total_ips : 9505.78 img/s
DLL 2021-05-28 17:14:55.773321 - Epoch: 0 Iteration: 4  train.loss : 7.00951  train.total_ips : 9416.69 img/s
DLL 2021-05-28 17:14:55.988907 - Epoch: 0 Iteration: 5  train.loss : 7.03843  train.total_ips : 9502.59 img/s
DLL 2021-05-28 17:14:56.204422 - Epoch: 0 Iteration: 6  train.loss : 7.06835  train.total_ips : 9505.94 img/s
DLL 2021-05-28 17:14:56.420238 - Epoch: 0 Iteration: 7  train.loss : 7.13445  train.total_ips : 9492.67 img/s
DLL 2021-05-28 17:14:56.635525 - Epoch: 0 Iteration: 8  train.loss : 7.12027  train.total_ips : 9515.95 img/s
DLL 2021-05-28 17:14:56.850890 - Epoch: 0 Iteration: 9  train.loss : 7.12769  train.total_ips : 9512.35 img/s
DLL 2021-05-28 17:14:57.066468 - Epoch: 0 Iteration: 10  train.loss : 7.11446  train.total_ips : 9503.15 img/s
DLL 2021-05-28 17:14:57.281908 - Epoch: 0 Iteration: 11  train.loss : 7.15525  train.total_ips : 9509.10 img/s
DLL 2021-05-28 17:14:57.497223 - Epoch: 0 Iteration: 12  train.loss : 7.09649  train.total_ips : 9514.71 img/s
DLL 2021-05-28 17:14:57.712654 - Epoch: 0 Iteration: 13  train.loss : 7.11925  train.total_ips : 9509.36 img/s
DLL 2021-05-28 17:14:57.927846 - Epoch: 0 Iteration: 14  train.loss : 7.11656  train.total_ips : 9520.29 img/s
DLL 2021-05-28 17:14:58.143162 - Epoch: 0 Iteration: 15  train.loss : 7.17000  train.total_ips : 9514.53 img/s
DLL 2021-05-28 17:14:58.358567 - Epoch: 0 Iteration: 16  train.loss : 7.17544  train.total_ips : 9510.49 img/s
DLL 2021-05-28 17:14:58.574009 - Epoch: 0 Iteration: 17  train.loss : 7.16173  train.total_ips : 9509.31 img/s
DLL 2021-05-28 17:14:58.789288 - Epoch: 0 Iteration: 18  train.loss : 7.25849  train.total_ips : 9516.15 img/s
DLL 2021-05-28 17:14:59.004853 - Epoch: 0 Iteration: 19  train.loss : 7.20540  train.total_ips : 9503.81 img/s
DLL 2021-05-28 17:14:59.220357 - Epoch: 0 Iteration: 20  train.loss : 7.23342  train.total_ips : 9506.44 img/s
DLL 2021-05-28 17:14:59.436070 - Epoch: 0 Iteration: 21  train.loss : 7.25969  train.total_ips : 9496.98 img/s
DLL 2021-05-28 17:14:59.651856 - Epoch: 0 Iteration: 22  train.loss : 7.23479  train.total_ips : 9494.22 img/s
DLL 2021-05-28 17:14:59.867347 - Epoch: 0 Iteration: 23  train.loss : 7.35369  train.total_ips : 9506.97 img/s
DLL 2021-05-28 17:15:00.082845 - Epoch: 0 Iteration: 24  train.loss : 7.21173  train.total_ips : 9506.63 img/s
DLL 2021-05-28 17:15:00.298261 - Epoch: 0 Iteration: 25  train.loss : 7.30741  train.total_ips : 9510.24 img/s
DLL 2021-05-28 17:15:00.513773 - Epoch: 0 Iteration: 26  train.loss : 7.13605  train.total_ips : 9506.04 img/s
DLL 2021-05-28 17:15:00.729141 - Epoch: 0 Iteration: 27  train.loss : 7.17792  train.total_ips : 9512.53 img/s
DLL 2021-05-28 17:15:00.944505 - Epoch: 0 Iteration: 28  train.loss : 7.23701  train.total_ips : 9512.48 img/s
DLL 2021-05-28 17:15:01.160129 - Epoch: 0 Iteration: 29  train.loss : 7.08470  train.total_ips : 9501.46 img/s
DLL 2021-05-28 17:15:01.375724 - Epoch: 0 Iteration: 30  train.loss : 7.14425  train.total_ips : 9502.41 img/s
DLL 2021-05-28 17:15:01.591367 - Epoch: 0 Iteration: 31  train.loss : 7.11882  train.total_ips : 9500.16 img/s
DLL 2021-05-28 17:15:01.806690 - Epoch: 0 Iteration: 32  train.loss : 7.09586  train.total_ips : 9514.21 img/s
DLL 2021-05-28 17:15:02.022133 - Epoch: 0 Iteration: 33  train.loss : 7.15668  train.total_ips : 9509.25 img/s
DLL 2021-05-28 17:15:02.237678 - Epoch: 0 Iteration: 34  train.loss : 7.08799  train.total_ips : 9504.45 img/s
DLL 2021-05-28 17:15:02.452985 - Epoch: 0 Iteration: 35  train.loss : 7.13251  train.total_ips : 9515.20 img/s
DLL 2021-05-28 17:15:02.668595 - Epoch: 0 Iteration: 36  train.loss : 7.06771  train.total_ips : 9501.56 img/s
DLL 2021-05-28 17:15:02.884104 - Epoch: 0 Iteration: 37  train.loss : 7.01797  train.total_ips : 9506.40 img/s
DLL 2021-05-28 17:15:03.099910 - Epoch: 0 Iteration: 38  train.loss : 7.03379  train.total_ips : 9493.05 img/s
DLL 2021-05-28 17:15:03.315280 - Epoch: 0 Iteration: 39  train.loss : 7.05871  train.total_ips : 9512.10 img/s
DLL 2021-05-28 17:15:03.530886 - Epoch: 0 Iteration: 40  train.loss : 7.18221  train.total_ips : 9501.80 img/s
DLL 2021-05-28 17:15:03.746083 - Epoch: 0 Iteration: 41  train.loss : 7.09428  train.total_ips : 9520.35 img/s
DLL 2021-05-28 17:15:03.962340 - Epoch: 0 Iteration: 42  train.loss : 7.00847  train.total_ips : 9473.59 img/s
DLL 2021-05-28 17:15:04.177873 - Epoch: 0 Iteration: 43  train.loss : 7.00333  train.total_ips : 9505.20 img/s
DLL 2021-05-28 17:15:04.393860 - Epoch: 0 Iteration: 44  train.loss : 7.01311  train.total_ips : 9484.99 img/s
DLL 2021-05-28 17:15:04.609194 - Epoch: 0 Iteration: 45  train.loss : 7.05024  train.total_ips : 9513.93 img/s
DLL 2021-05-28 17:15:04.824604 - Epoch: 0 Iteration: 46  train.loss : 6.99307  train.total_ips : 9510.37 img/s
DLL 2021-05-28 17:15:05.039827 - Epoch: 0 Iteration: 47  train.loss : 6.95135  train.total_ips : 9518.83 img/s
DLL 2021-05-28 17:15:05.255320 - Epoch: 0 Iteration: 48  train.loss : 6.95986  train.total_ips : 9506.85 img/s
DLL 2021-05-28 17:15:05.470838 - Epoch: 0 Iteration: 49  train.loss : 6.98696  train.total_ips : 9505.92 img/s
DLL 2021-05-28 17:15:05.686179 - Epoch: 0 Iteration: 50  train.loss : 6.97449  train.total_ips : 9513.73 img/s
DLL 2021-05-28 17:15:05.901521 - Epoch: 0 Iteration: 51  train.loss : 6.94372  train.total_ips : 9513.55 img/s
DLL 2021-05-28 17:15:06.116921 - Epoch: 0 Iteration: 52  train.loss : 6.96428  train.total_ips : 9511.09 img/s
DLL 2021-05-28 17:15:06.332468 - Epoch: 0 Iteration: 53  train.loss : 6.94166  train.total_ips : 9504.32 img/s
DLL 2021-05-28 17:15:06.547991 - Epoch: 0 Iteration: 54  train.loss : 6.94099  train.total_ips : 9505.47 img/s
DLL 2021-05-28 17:15:06.763385 - Epoch: 0 Iteration: 55  train.loss : 6.95464  train.total_ips : 9511.34 img/s
DLL 2021-05-28 17:15:06.978827 - Epoch: 0 Iteration: 56  train.loss : 6.96040  train.total_ips : 9509.04 img/s
DLL 2021-05-28 17:15:07.194386 - Epoch: 0 Iteration: 57  train.loss : 6.90740  train.total_ips : 9504.01 img/s
DLL 2021-05-28 17:15:07.409810 - Epoch: 0 Iteration: 58  train.loss : 6.92841  train.total_ips : 9509.75 img/s
DLL 2021-05-28 17:15:07.625363 - Epoch: 0 Iteration: 59  train.loss : 6.93011  train.total_ips : 9504.23 img/s
DLL 2021-05-28 17:15:07.840788 - Epoch: 0 Iteration: 60  train.loss : 6.94156  train.total_ips : 9510.17 img/s
DLL 2021-05-28 17:15:08.056378 - Epoch: 0 Iteration: 61  train.loss : 6.94608  train.total_ips : 9502.54 img/s
DLL 2021-05-28 17:15:08.271709 - Epoch: 0 Iteration: 62  train.loss : 6.89352  train.total_ips : 9514.00 img/s
DLL 2021-05-28 17:15:08.487167 - Epoch: 0 Iteration: 63  train.loss : 6.91363  train.total_ips : 9508.44 img/s
DLL 2021-05-28 17:15:08.702670 - Epoch: 0 Iteration: 64  train.loss : 6.88723  train.total_ips : 9506.63 img/s
DLL 2021-05-28 17:15:08.918176 - Epoch: 0 Iteration: 65  train.loss : 6.91085  train.total_ips : 9506.61 img/s
DLL 2021-05-28 17:15:09.133709 - Epoch: 0 Iteration: 66  train.loss : 6.94798  train.total_ips : 9505.06 img/s
DLL 2021-05-28 17:15:09.349059 - Epoch: 0 Iteration: 67  train.loss : 6.89680  train.total_ips : 9513.39 img/s
DLL 2021-05-28 17:15:09.564581 - Epoch: 0 Iteration: 68  train.loss : 6.90102  train.total_ips : 9505.64 img/s
DLL 2021-05-28 17:15:09.779895 - Epoch: 0 Iteration: 69  train.loss : 6.92725  train.total_ips : 9514.65 img/s
DLL 2021-05-28 17:15:09.995363 - Epoch: 0 Iteration: 70  train.loss : 6.88872  train.total_ips : 9508.03 img/s
DLL 2021-05-28 17:15:10.210618 - Epoch: 0 Iteration: 71  train.loss : 6.90243  train.total_ips : 9517.27 img/s
DLL 2021-05-28 17:15:10.426003 - Epoch: 0 Iteration: 72  train.loss : 6.88011  train.total_ips : 9511.42 img/s
DLL 2021-05-28 17:15:10.641438 - Epoch: 0 Iteration: 73  train.loss : 6.85563  train.total_ips : 9509.40 img/s
DLL 2021-05-28 17:15:10.856857 - Epoch: 0 Iteration: 74  train.loss : 6.86869  train.total_ips : 9510.04 img/s
DLL 2021-05-28 17:15:11.072215 - Epoch: 0 Iteration: 75  train.loss : 6.88653  train.total_ips : 9512.77 img/s
DLL 2021-05-28 17:15:11.287858 - Epoch: 0 Iteration: 76  train.loss : 6.86052  train.total_ips : 9500.46 img/s
DLL 2021-05-28 17:15:11.503238 - Epoch: 0 Iteration: 77  train.loss : 6.85037  train.total_ips : 9511.78 img/s
DLL 2021-05-28 17:15:11.718862 - Epoch: 0 Iteration: 78  train.loss : 6.88019  train.total_ips : 9500.85 img/s
DLL 2021-05-28 17:15:11.934252 - Epoch: 0 Iteration: 79  train.loss : 6.87800  train.total_ips : 9511.38 img/s
DLL 2021-05-28 17:15:12.149522 - Epoch: 0 Iteration: 80  train.loss : 6.83973  train.total_ips : 9516.78 img/s
DLL 2021-05-28 17:15:12.364845 - Epoch: 0 Iteration: 81  train.loss : 6.83108  train.total_ips : 9514.43 img/s
DLL 2021-05-28 17:15:12.580296 - Epoch: 0 Iteration: 82  train.loss : 6.83465  train.total_ips : 9508.71 img/s
DLL 2021-05-28 17:15:12.796655 - Epoch: 0 Iteration: 83  train.loss : 6.84755  train.total_ips : 9468.75 img/s
DLL 2021-05-28 17:15:13.012107 - Epoch: 0 Iteration: 84  train.loss : 6.84726  train.total_ips : 9508.62 img/s
DLL 2021-05-28 17:15:13.227496 - Epoch: 0 Iteration: 85  train.loss : 6.89481  train.total_ips : 9511.31 img/s
DLL 2021-05-28 17:15:13.442798 - Epoch: 0 Iteration: 86  train.loss : 6.84134  train.total_ips : 9515.20 img/s
DLL 2021-05-28 17:15:13.658160 - Epoch: 0 Iteration: 87  train.loss : 6.85256  train.total_ips : 9512.65 img/s
DLL 2021-05-28 17:15:13.873601 - Epoch: 0 Iteration: 88  train.loss : 6.83600  train.total_ips : 9509.03 img/s
DLL 2021-05-28 17:15:14.088798 - Epoch: 0 Iteration: 89  train.loss : 6.90687  train.total_ips : 9519.87 img/s
DLL 2021-05-28 17:15:14.304245 - Epoch: 0 Iteration: 90  train.loss : 6.80291  train.total_ips : 9508.69 img/s
DLL 2021-05-28 17:15:14.519743 - Epoch: 0 Iteration: 91  train.loss : 6.83896  train.total_ips : 9506.69 img/s
DLL 2021-05-28 17:15:14.735196 - Epoch: 0 Iteration: 92  train.loss : 6.84822  train.total_ips : 9508.61 img/s
DLL 2021-05-28 17:15:14.950782 - Epoch: 0 Iteration: 93  train.loss : 6.82317  train.total_ips : 9502.67 img/s
DLL 2021-05-28 17:15:15.166304 - Epoch: 0 Iteration: 94  train.loss : 6.79915  train.total_ips : 9505.77 img/s
DLL 2021-05-28 17:15:15.382087 - Epoch: 0 Iteration: 95  train.loss : 6.80472  train.total_ips : 9494.07 img/s
DLL 2021-05-28 17:15:15.597625 - Epoch: 0 Iteration: 96  train.loss : 6.79610  train.total_ips : 9504.94 img/s
DLL 2021-05-28 17:15:15.813213 - Epoch: 0 Iteration: 97  train.loss : 6.79047  train.total_ips : 9502.58 img/s
DLL 2021-05-28 17:15:16.028563 - Epoch: 0 Iteration: 98  train.loss : 6.78287  train.total_ips : 9513.17 img/s
DLL 2021-05-28 17:15:16.243853 - Epoch: 0 Iteration: 99  train.loss : 6.80151  train.total_ips : 9515.71 img/s
DLL 2021-05-28 17:15:16.459297 - Epoch: 0  train.loss : 6.99383  train.total_ips : 9411.41 img/s
DLL 2021-05-28 17:15:16.459416 - Epoch: 0  lr : 0.1  train.compute_ips : 9448.27 img/s train.data_time : 0.00133 s train.compute_time : 0.68659 s
DLL 2021-05-28 17:15:16.459478 - Summary: train.loss : 6.99383  train.total_ips : 9411.41 img/s
DLL 2021-05-28 17:15:16.459507 - Summary: lr : 0.1  train.compute_ips : 9448.27 img/s train.data_time : 0.00133 s train.compute_time : 0.68659 s
Experiment ended
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'job_gpu8.sh.7164550.result.amp.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7164550.1.gpua/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'job_gpu8.sh.7164550.result.amp.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7164550.1.gpua/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'job_gpu8.sh.7164550.result.amp.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7164550.1.gpua/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'job_gpu8.sh.7164550.result.amp.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7164550.1.gpua/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'job_gpu8.sh.7164550.result.amp.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7164550.1.gpua/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'job_gpu8.sh.7164550.result.amp.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7164550.1.gpua/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'job_gpu8.sh.7164550.result.amp.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7164550.1.gpua/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'job_gpu8.sh.7164550.result.amp.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7164550.1.gpua/imagenet']
