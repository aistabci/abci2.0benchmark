g0115.abci.local
Time for stage-in: 178


Warning:  if --fp16 is not used, static_loss_scale will be ignored.
=> creating model '('resnet50', 'classic', 1000)'
Version: {'net': <class 'image_classification.resnet.ResNet'>, 'block': <class 'image_classification.resnet.Bottleneck'>, 'layers': [3, 4, 6, 3], 'widths': [64, 128, 256, 512], 'expansion': 4}
Config: {'conv': <class 'torch.nn.modules.conv.Conv2d'>, 'conv_init': 'fan_out', 'nonlinearity': 'relu', 'last_bn_0_init': False, 'activation': <function <lambda> at 0x2b9b8d2ac670>}
Num classes: 1000
read 1281167 files from 1000 directories
read 50000 files from 1000 directories
DLL 2021-05-14 09:36:44.013404 - PARAMETER data : /local/7063049.1.gpu/imagenet  data_backend : dali-cpu  arch : resnet50  model_config : classic  num_classes : 1000  workers : 5  epochs : 1  run_epochs : -1  batch_size : 256  optimizer_batch_size : -1  lr : 0.1  lr_schedule : step  warmup : 0  label_smoothing : 0.0  mixup : 0.0  momentum : 0.9  weight_decay : 0.0001  bn_weight_decay : False  nesterov : False  print_freq : 1  resume : None  pretrained_weights :   fp16 : False  static_loss_scale : 256.0  dynamic_loss_scale : False  prof : 100  amp : True  seed : None  gather_checkpoints : False  raport_file : benchmark_result.json  evaluate : False  training_only : True  save_checkpoints : False  checkpoint_filename : checkpoint.pth.tar  workspace : ./  memory_format : nchw  distributed : True  local_rank : 0  gpu : 0  world_size : 4 
 ! Weight decay NOT applied to BN parameters 
98
63
Selected optimization level O1:  Insert automatic casts around Pytorch functions and Tensor methods.

Defaults for this optimization level are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O1
cast_model_type        : None
patch_torch_functions  : True
keep_batchnorm_fp32    : None
master_weights         : None
loss_scale             : 256.0
RUNNING EPOCHS FROM 0 TO 1
DLL 2021-05-14 09:37:30.296080 - Epoch: 0 Iteration: 1  train.loss : 7.08306  train.total_ips : 22.64 img/s
DLL 2021-05-14 09:37:30.610689 - Epoch: 0 Iteration: 2  train.loss : 7.03292  train.total_ips : 3255.74 img/s
DLL 2021-05-14 09:37:30.924918 - Epoch: 0 Iteration: 3  train.loss : 7.12916  train.total_ips : 3259.64 img/s
DLL 2021-05-14 09:37:31.239072 - Epoch: 0 Iteration: 4  train.loss : 7.13606  train.total_ips : 3260.44 img/s
DLL 2021-05-14 09:37:31.553567 - Epoch: 0 Iteration: 5  train.loss : 7.08985  train.total_ips : 3256.95 img/s
DLL 2021-05-14 09:37:31.868112 - Epoch: 0 Iteration: 6  train.loss : 7.21460  train.total_ips : 3256.39 img/s
DLL 2021-05-14 09:37:32.182618 - Epoch: 0 Iteration: 7  train.loss : 7.29516  train.total_ips : 3256.79 img/s
DLL 2021-05-14 09:37:32.496821 - Epoch: 0 Iteration: 8  train.loss : 7.32734  train.total_ips : 3259.96 img/s
DLL 2021-05-14 09:37:32.810976 - Epoch: 0 Iteration: 9  train.loss : 7.38972  train.total_ips : 3260.38 img/s
DLL 2021-05-14 09:37:33.125188 - Epoch: 0 Iteration: 10  train.loss : 7.37313  train.total_ips : 3259.79 img/s
DLL 2021-05-14 09:37:33.439866 - Epoch: 0 Iteration: 11  train.loss : 7.30920  train.total_ips : 3255.00 img/s
DLL 2021-05-14 09:37:33.754279 - Epoch: 0 Iteration: 12  train.loss : 7.43528  train.total_ips : 3257.90 img/s
DLL 2021-05-14 09:37:34.069083 - Epoch: 0 Iteration: 13  train.loss : 7.52248  train.total_ips : 3253.78 img/s
DLL 2021-05-14 09:37:34.382981 - Epoch: 0 Iteration: 14  train.loss : 7.40328  train.total_ips : 3263.06 img/s
DLL 2021-05-14 09:37:34.697591 - Epoch: 0 Iteration: 15  train.loss : 7.41867  train.total_ips : 3255.69 img/s
DLL 2021-05-14 09:37:35.011844 - Epoch: 0 Iteration: 16  train.loss : 7.42252  train.total_ips : 3259.33 img/s
DLL 2021-05-14 09:37:35.325890 - Epoch: 0 Iteration: 17  train.loss : 7.37394  train.total_ips : 3261.56 img/s
DLL 2021-05-14 09:37:35.639689 - Epoch: 0 Iteration: 18  train.loss : 7.45914  train.total_ips : 3264.06 img/s
DLL 2021-05-14 09:37:35.953134 - Epoch: 0 Iteration: 19  train.loss : 7.37203  train.total_ips : 3267.70 img/s
DLL 2021-05-14 09:37:36.266830 - Epoch: 0 Iteration: 20  train.loss : 7.75461  train.total_ips : 3265.19 img/s
DLL 2021-05-14 09:37:36.580932 - Epoch: 0 Iteration: 21  train.loss : 7.44813  train.total_ips : 3261.04 img/s
DLL 2021-05-14 09:37:36.895247 - Epoch: 0 Iteration: 22  train.loss : 7.13720  train.total_ips : 3258.73 img/s
DLL 2021-05-14 09:37:37.208865 - Epoch: 0 Iteration: 23  train.loss : 7.26108  train.total_ips : 3265.96 img/s
DLL 2021-05-14 09:37:37.522838 - Epoch: 0 Iteration: 24  train.loss : 7.84063  train.total_ips : 3262.25 img/s
DLL 2021-05-14 09:37:37.836187 - Epoch: 0 Iteration: 25  train.loss : 7.34170  train.total_ips : 3268.80 img/s
DLL 2021-05-14 09:37:38.150178 - Epoch: 0 Iteration: 26  train.loss : 7.15842  train.total_ips : 3262.10 img/s
DLL 2021-05-14 09:37:38.464822 - Epoch: 0 Iteration: 27  train.loss : 7.47632  train.total_ips : 3255.29 img/s
DLL 2021-05-14 09:37:38.778620 - Epoch: 0 Iteration: 28  train.loss : 7.26321  train.total_ips : 3264.17 img/s
DLL 2021-05-14 09:37:39.092682 - Epoch: 0 Iteration: 29  train.loss : 7.33917  train.total_ips : 3261.37 img/s
DLL 2021-05-14 09:37:39.406636 - Epoch: 0 Iteration: 30  train.loss : 7.31684  train.total_ips : 3262.43 img/s
DLL 2021-05-14 09:37:39.720472 - Epoch: 0 Iteration: 31  train.loss : 7.02027  train.total_ips : 3263.70 img/s
DLL 2021-05-14 09:37:40.033785 - Epoch: 0 Iteration: 32  train.loss : 7.06241  train.total_ips : 3269.13 img/s
DLL 2021-05-14 09:37:40.347133 - Epoch: 0 Iteration: 33  train.loss : 7.05232  train.total_ips : 3268.87 img/s
DLL 2021-05-14 09:37:40.661362 - Epoch: 0 Iteration: 34  train.loss : 7.10211  train.total_ips : 3259.63 img/s
DLL 2021-05-14 09:37:40.975154 - Epoch: 0 Iteration: 35  train.loss : 7.11822  train.total_ips : 3264.16 img/s
DLL 2021-05-14 09:37:41.288538 - Epoch: 0 Iteration: 36  train.loss : 7.04226  train.total_ips : 3268.43 img/s
DLL 2021-05-14 09:37:41.602819 - Epoch: 0 Iteration: 37  train.loss : 7.01696  train.total_ips : 3259.05 img/s
DLL 2021-05-14 09:37:41.916789 - Epoch: 0 Iteration: 38  train.loss : 6.96710  train.total_ips : 3262.35 img/s
DLL 2021-05-14 09:37:42.229941 - Epoch: 0 Iteration: 39  train.loss : 7.07602  train.total_ips : 3270.93 img/s
DLL 2021-05-14 09:37:42.543346 - Epoch: 0 Iteration: 40  train.loss : 6.99817  train.total_ips : 3268.17 img/s
DLL 2021-05-14 09:37:42.856641 - Epoch: 0 Iteration: 41  train.loss : 6.97172  train.total_ips : 3269.44 img/s
DLL 2021-05-14 09:37:43.169971 - Epoch: 0 Iteration: 42  train.loss : 7.02611  train.total_ips : 3268.94 img/s
DLL 2021-05-14 09:37:43.483933 - Epoch: 0 Iteration: 43  train.loss : 7.02993  train.total_ips : 3262.43 img/s
DLL 2021-05-14 09:37:43.797755 - Epoch: 0 Iteration: 44  train.loss : 6.96553  train.total_ips : 3263.88 img/s
DLL 2021-05-14 09:37:44.111093 - Epoch: 0 Iteration: 45  train.loss : 7.05973  train.total_ips : 3268.92 img/s
DLL 2021-05-14 09:37:44.424766 - Epoch: 0 Iteration: 46  train.loss : 6.97674  train.total_ips : 3265.41 img/s
DLL 2021-05-14 09:37:44.738829 - Epoch: 0 Iteration: 47  train.loss : 6.94361  train.total_ips : 3261.32 img/s
DLL 2021-05-14 09:37:45.052386 - Epoch: 0 Iteration: 48  train.loss : 7.15265  train.total_ips : 3266.57 img/s
DLL 2021-05-14 09:37:45.365596 - Epoch: 0 Iteration: 49  train.loss : 7.00829  train.total_ips : 3270.36 img/s
DLL 2021-05-14 09:37:45.679661 - Epoch: 0 Iteration: 50  train.loss : 6.93593  train.total_ips : 3261.34 img/s
DLL 2021-05-14 09:37:45.993428 - Epoch: 0 Iteration: 51  train.loss : 7.01890  train.total_ips : 3264.57 img/s
DLL 2021-05-14 09:37:46.307273 - Epoch: 0 Iteration: 52  train.loss : 6.97764  train.total_ips : 3263.44 img/s
DLL 2021-05-14 09:37:46.621543 - Epoch: 0 Iteration: 53  train.loss : 6.95717  train.total_ips : 3259.26 img/s
DLL 2021-05-14 09:37:46.935448 - Epoch: 0 Iteration: 54  train.loss : 6.91266  train.total_ips : 3262.93 img/s
DLL 2021-05-14 09:37:47.249565 - Epoch: 0 Iteration: 55  train.loss : 6.93814  train.total_ips : 3260.92 img/s
DLL 2021-05-14 09:37:47.563010 - Epoch: 0 Iteration: 56  train.loss : 6.93750  train.total_ips : 3267.79 img/s
DLL 2021-05-14 09:37:47.876651 - Epoch: 0 Iteration: 57  train.loss : 6.93061  train.total_ips : 3265.75 img/s
DLL 2021-05-14 09:37:48.190629 - Epoch: 0 Iteration: 58  train.loss : 6.92021  train.total_ips : 3262.23 img/s
DLL 2021-05-14 09:37:48.504430 - Epoch: 0 Iteration: 59  train.loss : 6.91896  train.total_ips : 3264.05 img/s
DLL 2021-05-14 09:37:48.818161 - Epoch: 0 Iteration: 60  train.loss : 6.91017  train.total_ips : 3264.83 img/s
DLL 2021-05-14 09:37:49.131952 - Epoch: 0 Iteration: 61  train.loss : 6.93332  train.total_ips : 3264.12 img/s
DLL 2021-05-14 09:37:49.445174 - Epoch: 0 Iteration: 62  train.loss : 6.92321  train.total_ips : 3270.12 img/s
DLL 2021-05-14 09:37:49.758345 - Epoch: 0 Iteration: 63  train.loss : 6.93222  train.total_ips : 3270.71 img/s
DLL 2021-05-14 09:37:50.071897 - Epoch: 0 Iteration: 64  train.loss : 6.90656  train.total_ips : 3266.69 img/s
DLL 2021-05-14 09:37:50.385348 - Epoch: 0 Iteration: 65  train.loss : 6.92286  train.total_ips : 3267.75 img/s
DLL 2021-05-14 09:37:50.698988 - Epoch: 0 Iteration: 66  train.loss : 6.98013  train.total_ips : 3265.72 img/s
DLL 2021-05-14 09:37:51.012624 - Epoch: 0 Iteration: 67  train.loss : 6.91874  train.total_ips : 3265.75 img/s
DLL 2021-05-14 09:37:51.326120 - Epoch: 0 Iteration: 68  train.loss : 6.95061  train.total_ips : 3267.33 img/s
DLL 2021-05-14 09:37:51.639550 - Epoch: 0 Iteration: 69  train.loss : 6.92403  train.total_ips : 3268.05 img/s
DLL 2021-05-14 09:37:51.952287 - Epoch: 0 Iteration: 70  train.loss : 6.94341  train.total_ips : 3275.21 img/s
DLL 2021-05-14 09:37:52.266315 - Epoch: 0 Iteration: 71  train.loss : 6.98083  train.total_ips : 3261.73 img/s
DLL 2021-05-14 09:37:52.579444 - Epoch: 0 Iteration: 72  train.loss : 6.91943  train.total_ips : 3271.09 img/s
DLL 2021-05-14 09:37:52.892984 - Epoch: 0 Iteration: 73  train.loss : 6.91841  train.total_ips : 3266.76 img/s
DLL 2021-05-14 09:37:53.206652 - Epoch: 0 Iteration: 74  train.loss : 6.91465  train.total_ips : 3265.49 img/s
DLL 2021-05-14 09:37:53.520166 - Epoch: 0 Iteration: 75  train.loss : 6.90943  train.total_ips : 3267.01 img/s
DLL 2021-05-14 09:37:53.833741 - Epoch: 0 Iteration: 76  train.loss : 6.90971  train.total_ips : 3266.41 img/s
DLL 2021-05-14 09:37:54.147452 - Epoch: 0 Iteration: 77  train.loss : 6.92354  train.total_ips : 3265.06 img/s
DLL 2021-05-14 09:37:54.460987 - Epoch: 0 Iteration: 78  train.loss : 6.90715  train.total_ips : 3266.79 img/s
DLL 2021-05-14 09:37:54.774351 - Epoch: 0 Iteration: 79  train.loss : 6.95723  train.total_ips : 3268.60 img/s
DLL 2021-05-14 09:37:55.087924 - Epoch: 0 Iteration: 80  train.loss : 6.92775  train.total_ips : 3266.42 img/s
DLL 2021-05-14 09:37:55.401626 - Epoch: 0 Iteration: 81  train.loss : 6.91126  train.total_ips : 3265.11 img/s
DLL 2021-05-14 09:37:55.715902 - Epoch: 0 Iteration: 82  train.loss : 6.89967  train.total_ips : 3259.16 img/s
DLL 2021-05-14 09:37:56.029461 - Epoch: 0 Iteration: 83  train.loss : 6.93836  train.total_ips : 3266.61 img/s
DLL 2021-05-14 09:37:56.343562 - Epoch: 0 Iteration: 84  train.loss : 6.90052  train.total_ips : 3261.02 img/s
DLL 2021-05-14 09:37:56.658038 - Epoch: 0 Iteration: 85  train.loss : 6.91113  train.total_ips : 3257.09 img/s
DLL 2021-05-14 09:37:56.972015 - Epoch: 0 Iteration: 86  train.loss : 6.91628  train.total_ips : 3262.21 img/s
DLL 2021-05-14 09:37:57.285751 - Epoch: 0 Iteration: 87  train.loss : 6.90895  train.total_ips : 3264.78 img/s
DLL 2021-05-14 09:37:57.600232 - Epoch: 0 Iteration: 88  train.loss : 6.90435  train.total_ips : 3257.03 img/s
DLL 2021-05-14 09:37:57.914169 - Epoch: 0 Iteration: 89  train.loss : 6.92880  train.total_ips : 3262.59 img/s
DLL 2021-05-14 09:37:58.228071 - Epoch: 0 Iteration: 90  train.loss : 6.90605  train.total_ips : 3263.16 img/s
DLL 2021-05-14 09:37:58.541587 - Epoch: 0 Iteration: 91  train.loss : 6.90303  train.total_ips : 3267.04 img/s
DLL 2021-05-14 09:37:58.855111 - Epoch: 0 Iteration: 92  train.loss : 6.90228  train.total_ips : 3266.91 img/s
DLL 2021-05-14 09:37:59.168965 - Epoch: 0 Iteration: 93  train.loss : 6.89985  train.total_ips : 3263.51 img/s
DLL 2021-05-14 09:37:59.483042 - Epoch: 0 Iteration: 94  train.loss : 6.91726  train.total_ips : 3261.19 img/s
DLL 2021-05-14 09:37:59.796425 - Epoch: 0 Iteration: 95  train.loss : 6.88897  train.total_ips : 3268.37 img/s
DLL 2021-05-14 09:38:00.109945 - Epoch: 0 Iteration: 96  train.loss : 6.89559  train.total_ips : 3267.00 img/s
DLL 2021-05-14 09:38:00.423807 - Epoch: 0 Iteration: 97  train.loss : 6.90035  train.total_ips : 3263.53 img/s
DLL 2021-05-14 09:38:00.738010 - Epoch: 0 Iteration: 98  train.loss : 6.90083  train.total_ips : 3259.87 img/s
DLL 2021-05-14 09:38:01.051704 - Epoch: 0 Iteration: 99  train.loss : 6.91131  train.total_ips : 3265.17 img/s
DLL 2021-05-14 09:38:01.364706 - Epoch: 0  train.loss : 7.06849  train.total_ips : 3231.44 img/s
DLL 2021-05-14 09:38:01.364924 - Epoch: 0  lr : 0.1  train.compute_ips : 3243.58 img/s train.data_time : 0.00170 s train.compute_time : 0.76124 s
DLL 2021-05-14 09:38:01.365031 - Summary: train.loss : 7.06849  train.total_ips : 3231.44 img/s
DLL 2021-05-14 09:38:01.365089 - Summary: lr : 0.1  train.compute_ips : 3243.58 img/s train.data_time : 0.00170 s train.compute_time : 0.76124 s
Experiment ended
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'benchmark_result.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7063049.1.gpu/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'benchmark_result.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7063049.1.gpu/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'benchmark_result.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7063049.1.gpu/imagenet']
['/opt/conda/bin/python', '-u', '/workspace/examples/resnet50v1.5/main.py', '--arch', 'resnet50', '--batch-size', '256', '--training-only', '--no-checkpoints', '--print-freq', '1', '--raport-file', 'benchmark_result.json', '--epochs', '1', '--prof', '100', '--amp', '--static-loss-scale', '256', '/local/7063049.1.gpu/imagenet']
